Q1-Q7
DROP TABLE Client 
DROP TABLE Facture 

CREATE TABLE Client 
(
    nom_cl VARCHAR(30) NOT NULL,
    ville VARCHAR(30) NOT NULL,
    telephone INT NOT NULL,
    age INT NOT NULL,
    PRIMARY KEY(nom_cl)
);

INSERT INTO Client 
	VALUES('Dupont', 'Toulouse', 1, 18);
INSERT INTO Client 
	VALUES('Durant', 'Tarbes', 2, 21);
INSERT INTO Client 
	VALUES('Dubois', 'Pau', 3, 41);
INSERT INTO Client 
	VALUES('Ducarton', 'Tarbes', 4, 65);
	
CREATE TABLE Facture 
(
    numero INT NOT NULL,
    date_f date NOT NULL,
    montant INT NOT NULL,
    nom_cl VARCHAR(30) NOT NULL,
    tva FLOAT NOT NULL,
    PRIMARY KEY(numero),
	FOREIGN KEY(nom_cl) REFERENCES Client(nom_cl)
);

INSERT INTO Facture 
	VALUES(1, '2000-04-04', 1200, 'Dupont',19.6);
INSERT INTO Facture 
	VALUES(2, '2000-10-11', 500, 'Durant',5.5);
INSERT INTO Facture 
	VALUES(3, '2000-11-12', 800, 'Dupont',19.6);
INSERT INTO Facture 
	VALUES(4, '2000-12-31', 2000, 'Dubois',5.5);
INSERT INTO Facture 
	VALUES(5, '2001-01-02', 900, 'Ducarton',19.6);
INSERT INTO Facture 
	VALUES(6, '2001-02-12', 500, 'Dubois',5.5);

Q2
SELECT numero, montant, montant+montant*(tva/100) as ttc FROM Facture

Q3
SELECT numero, montant, date_f FROM Facture 
WHERE nom_cl='Dupont'

Q4
SELECT nom_cl, SUM(montant) AS somme FROM Facture
GROUP BY nom_cl

Q5
SELECT nom_cl, AVG(montant) AS moyenne FROM Facture
GROUP BY nom_cl
HAVING COUNT(nom_cl)>=2

Q6
SELECT numero, montant FROM Facture
WHERE nom_cl='Dupont' OR nom_cl='Durant'

Q8
SELECT nom_cl, telephone FROM Client c
INNER JOIN Facture f ON c.nom_cl=f.nom_cl
WHERE ville='Toulouse' AND montant>=1000

Q9
SELECT ville, SUM(montant) AS ca FROM Client c
INNER JOIN Facture f ON c.nom_cl=f.nom_cl
WHERE ville='Toulouse' 

Q10
SELECT ville, SUM(montant) AS ca FROM Client c
INNER JOIN Facture f ON c.nom_cl=f.nom_cl
GROUP BY ville

Q11
SELECT ville, c.nom_cl AS ca FROM Client c
INNER JOIN Facture f ON c.nom_cl=f.nom_cl
WHERE ville='Toulouse' AND ville='Pau' AND ville='Tarbes'

Q12
UPDATE Client SET ville='Albi'
WHERE nom_cl='Dupont'

Q13
DELETE FROM Client
WHERE nom_cl='Dubois'


