Q1:
SELECT nom FROM Cycliste c 
INNER JOIN Classement cl ON cl.noCycliste=c.noCycliste
WHERE rangEtape=1 AND noEtape=1

SELECT nom FROM Cycliste 
WHERE noCycliste IN (
	SELECT noCycliste FROM Classement
	WHERE rangEtape=1 AND noEtape=1
	)
	
Q2:
SELECT nom FROM Cycliste c 
INNER JOIN Classement cl ON cl.noCycliste=c.noCycliste
WHERE rangGeneral=1 
GROUP BY noEtape
HAVING noEtape>=ALL (
	SELECT noEtape FROM Etape
	)
	
SELECT nom FROM Cycliste c 
INNER JOIN Classement cl ON cl.noCycliste=c.noCycliste
WHERE rangGeneral=1 
GROUP BY noEtape
HAVING noEtape=MAX(noEtape)

Q3:
SELECT equipe, SUM(prime) FROM Cycliste c
INNER JOIN Classement cl ON cl.noCycliste=c.noCycliste
INNER JOIN Etape e ON e.noEtape = cl.noEtape
WHERE rangEtape=1 AND equipe= "Cofidis" 
GROUP BY etape

Q4:
SELECT nom FROM Cycliste c
INNER JOIN Classement cl ON cl.noCycliste=c.noCycliste
INNER JOIN Etape e ON e.noEtape = cl.noEtape
WHERE rangEtape=1 AND villeDepart IN ("Toulouse", "Pau") 

Q5:
SELECT nom, SUM(prime) FROM Cycliste c
INNER JOIN Classement cl ON cl.noCycliste=c.noCycliste
INNER JOIN Etape e ON e.noEtape = cl.noEtape
WHERE rangEtape=1 
GROUP BY nom
HAVING SUM(prime)= MAX(SUM(prime))


SELECT nom, SUM(prime) FROM Cycliste c
INNER JOIN Classement cl ON cl.noCycliste=c.noCycliste
INNER JOIN Etape e ON e.noEtape = cl.noEtape
WHERE rangEtape=1 
GROUP BY nom
HAVING SUM(prime)>= ALL
(
	SELECT SUM(prime) FROM Classement cl
	INNER JOIN Etape e ON e.noEtape = cl.noEtape
	WHERE rangEtape=1 
	GROUP BY noCycliste
}

Q6:
a:
SELECT noEtape FROM Classement cl
INNER JOIN Cycliste cy ON cy.noCycliste=cl.noCycliste
WHERE equipe='USPostal' AND rangEtape=1

b:
SELECT noEtape FROM Classement 
WHERE rangEtape=1 AND noCycliste IN (
	SELECT noCycliste FROM Cycliste 
	WHERE equipe='USPostal' )

Q7:
SELECT DISTINCT noCycliste FROM Dopage
WHERE noEtape IN (2, 3)

SELECT DISTINCT noCycliste FROM Dopage
WHERE noEtape=2 OR noEtape=3

Q8:
SELECT nom FROM Cycliste cy
WHERE noCycliste NOT IN (
	SELECT noCycliste FROM Classement
	WHERE rangEtape=1
	GROUP BY noEtape)
	
Q9:
DELETE FROM Cycliste
WHERE noCycliste=1

